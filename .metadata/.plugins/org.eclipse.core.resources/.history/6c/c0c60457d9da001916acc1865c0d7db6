package br.hospital.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.List;

import br.hospital.dto.PacienteDto;
import br.hospital.jdbc.Conection;

public class PacienteDAO {
	
public void inserir(PacienteDto pacienteDTO){
		
		try {
		Connection connection = Conection.getInstance().getConnection();
		
		String sql = "INSERT INTO pacientes(nome, idade, temperatura, glicose) values(?, ?, ?, ?)";
		
		PreparedStatement statement = connection.prepareStatement(sql);
		
		statement.setString(1, pacienteDTO.getName());
		statement.setInt(2, pacienteDTO.getAge());
		statement.setDouble(3, pacienteDTO.getTemperature());
		statement.setInt(4, pacienteDTO.getGlicose());


		statement.execute();
		connection.close();
		}catch(Exception e) {
			e.printStackTrace();
		}

	}
	
	public List<PacienteDto> listarPacientes(){
		List<PacienteDto> listarPaciente = new ArrayList<PacienteDto>();
		try {
			Connection connection = Conection.getInstance().getConnection();
			
			String sql = "SELECT * FROM pacientes where glicose>100;";
			
			PreparedStatement statement = connection.prepareStatement(sql);
			ResultSet resultset = statement.executeQuery();
			
			while(resultset.next()) {
				PacienteDto pacienteDTO = new PacienteDto();
				pacienteDTO.setID_PACIENTE(resultset.getInt("ID_PACIENTE"));
				pacienteDTO.setName(resultset.getString("nome"));
				pacienteDTO.setAge(resultset.getInt("idade"));
				pacienteDTO.setTemperature(resultset.getDouble("temperatura"));
				pacienteDTO.setGlicose(resultset.getInt("glicose"));
				
				listarPaciente.add(pacienteDTO);

			}
				
			connection.close();
			
		}catch (Exception e) {
			e.printStackTrace();
		}
		return listarPaciente;
	}
	
	

}
